(this["webpackJsonpwebrtc-tesseract"]=this["webpackJsonpwebrtc-tesseract"]||[]).push([[0],{124:function(e,t,n){},161:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(35),o=n.n(a),s=(n(124),n(225)),i=n(64),u=n(107),l=n(248),d=n(12),b=n(234),j=n(232),f=n(42),h=n(228),m=Object(h.a)((function(e){return{root:{flexGrow:1,paddingTop:96,minHeight:"100vh",position:"relative"},devStreamer:{width:"100%",backgroundColor:f.a[100]},devStreamerMedia:{width:"100%",height:"100%",objectFit:"contain"},cannotUseModal:{display:"flex",alignItems:"center",justifyContent:"center"},cannotUseModalPaper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},fab:{position:"fixed!important",bottom:e.spacing(2),right:e.spacing(2),margin:e.spacing(1)},extendedIcon:{marginRight:e.spacing(1)},table:{minWidth:650}}})),O=n(230),x=n(233),v=n(217),p=n(2),g=function(e){var t=e.open,n=e.handleOpen,r=m();return Object(p.jsx)(O.a,{"aria-labelledby":"cannot-use-modal","aria-describedby":"cannot-use-this-site-without-chrome",className:r.cannotUseModal,open:t,onClose:n,closeAfterTransition:!0,BackdropComponent:x.a,BackdropProps:{timeout:500},children:Object(p.jsx)(v.a,{in:t,children:Object(p.jsxs)("div",{className:r.paper,children:[Object(p.jsx)("h2",{id:"transition-modal-title",children:"\uc0ac\uc6a9 \ubd88\uac00"}),Object(p.jsx)("p",{id:"transition-modal-description",children:"Chrome\uc5d0\uc11c\ub9cc \uc815\uc0c1 \ub3d9\uc791\ud569\ub2c8\ub2e4."})]})})})};g.defaultProps={open:!1};var w=g,y={CannotUseModal:w},k=n(16),C=n.n(k),S=n(29),M=n(235),P=n(236),E=n(237),L=n(238),T=n(239),N=n(241),R=n(242),D=n(227),A=n(60),F=c.a.createContext(),_=(F.Consumer,F.Provider),I=function(e){var t=e.workerCreateOption,n=e.children,c=e.onLoad,a=e.useSchedule,o=void 0===a||a,s=e.workerNumber,i=void 0===s?3:s,u=e.loadLanguage,l=void 0===u?"eng":u,b=e.initialize,j=void 0===b?"eng":b,f=e.workerParameter,h=void 0===f?{}:f,m=Object(r.useState)(!1),O=Object(d.a)(m,2),x=O[0],v=O[1],g=Object(r.useCallback)((function(e){var t=e.workers,n=e.scheduler;c&&c({workers:t,scheduler:n}),v(!0)}),[c]),w=Object(r.useMemo)((function(){return o&&Object(A.createScheduler)()}),[o]),y=Object(r.useMemo)((function(){return Promise.all((e=new Array(i),e.fill()).map(Object(S.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(A.createWorker)(t),console.log(new Date,"load worker"),e.next=4,n.load();case 4:return e.next=6,n.loadLanguage(l);case 6:return e.next=8,n.initialize(j);case 8:return e.next=10,n.setParameters(h);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)}))))).then((function(e){o&&e.forEach((function(e){w.addWorker(e)})),g({workers:e,scheduler:w})}));var e}),[t,i,l,j,h,o,w,g]),k=Object(r.useMemo)((function(){return{scheduler:w,workers:y,loaded:x}}),[x,w,y]);return Object(p.jsx)(_,{value:k,children:n})},B=n(37),H=n(68),V=Object(B.proxy)({rows:[]}),W={addLog:function(e){V.rows.push(function(e){var t=e.jobId,n=e.data;return{jobId:t,text:n.text,confidence:n.confidence,blocks:n.blocks,paragraphs:n.paragraphs,lines:n.lines}}(e))},clearLogs:function(){V.rows.length=0}},G={clearCanvas:function(e){e.getContext("2d").clearRect(0,0,e.width,e.height),e.getContext("2d").beginPath(),e.removeAttribute("width"),e.removeAttribute("height")},processFrame:{useCvProcess:function(e){var t=Object(i.b)(),n=t.cv,a=t.loaded,o=c.a.useContext(F).scheduler,s=Object(r.useMemo)((function(){return e(n,a,o)}),[n,a,e,o]),u=Object(d.a)(s,3);return{preProcess:u[0],process:u[1],clearProcess:u[2],cv:n,loaded:a}},createProcessGrayScaleAndShow:function(e,t,n){var r;return t?(window.PROCESS_DST=r,[function(){r=new e.Mat,W.clearLogs()},function(t){var c=t.src,a=t.canvas;e.cvtColor(c,r,e.COLOR_RGBA2GRAY),e.imshow(a,r),n.getQueueLen()<5&&(console.debug(new Date,"add job"),Object(S.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=W,e.next=3,n.addJob("recognize",a);case 3:e.t1=e.sent,e.t0.addLog.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})))())},function(){r.delete(),r=null}]):[function(){},function(){}]}}},U=n(226),z=function(e){var t=e.children,n=Object(r.useRef)(),c=Object(r.useState)({x:null,y:null}),a=Object(d.a)(c,2),o=a[0],s=a[1],i=Object(r.useMemo)((function(){return Object(B.proxy)({x:null,y:null})}),[]),u=Object(H.useSnapshot)(i),l=Object(r.useCallback)((function(e){e.ctrlKey||(e.target instanceof HTMLVideoElement&&e.layerX>=0&&e.layerY>=0?(i.x=e.layerX,i.y=e.layerY):(i.x=null,i.y=null))}),[i]);Object(r.useEffect)((function(){var e=n.current;return e.addEventListener("mousemove",l),function(){e.removeEventListener("mousemove",l)}}),[l]);var b=Object(r.useCallback)((function(e){var t=e.ctrlKey?u.x:e.layerX,n=e.ctrlKey?u.y:e.layerY;console.log({x:t,y:n}),e.target instanceof HTMLVideoElement&&t>=0&&n>=0&&(null!==o.x&&null!==o.y?(console.log({x1:o.x,y1:o.y,x2:t,y2:n,point1:o,point2:{x:t,y:n},width:Math.abs(o.x-t),height:Math.abs(o.y-n)}),s({x:null,y:null})):s({x:t,y:n}))}),[u,o]);Object(r.useEffect)((function(){var e=n.current;return e.addEventListener("click",b),function(){e.removeEventListener("click",b)}}),[b]);var j=Object(r.useCallback)((function(){return null!==u.x&&null!==u.y?"x:".concat(u.x,", y:").concat(u.y):""}),[u]);return Object(p.jsx)(U.a,{followCursor:!0,title:j(),ref:n,children:t})},Y=n(240),J=G.clearCanvas,K=G.processFrame,X=K.useCvProcess,q=K.createProcessGrayScaleAndShow,Q=function(e){var t=e.stream,n=e.setStream,c=m(),a=Object(H.useSnapshot)(V).rows,o=X(q),s=o.preProcess,i=o.process,u=o.clearProcess,l=o.cv,b=Object(r.useRef)(HTMLVideoElement.prototype),f=Object(r.useRef)(HTMLCanvasElement.prototype),h=Object(r.useRef)(null),O=Object(r.useRef)(),x=Object(r.useCallback)((function(){h.current&&(h.current.delete(),h.current=null),v.current&&(cancelAnimationFrame(v.current),v.current=null),J(f.current),u()}),[u]),v=Object(r.useRef)(),g=Object(r.useRef)(30),w=Object(r.useCallback)((function(){try{O.current.read(h.current),i({src:h.current,canvas:f.current}),v.current=requestAnimationFrame(w)}catch(e){console.error(e)}}),[i]),y=Object(r.useCallback)((function(){console.debug(new Date,"start");var e=b.current,t=e.srcObject,n=e.videoHeight,r=e.videoWidth,c=t.getVideoTracks()[0].getSettings().frameRate;g.current=c,h.current=new l.Mat(n,r,l.CV_8UC4),O.current=new l.VideoCapture(b.current),s(),v.current=requestAnimationFrame(w)}),[s,w,l]);Object(r.useEffect)((function(){if(t&&t instanceof MediaStream&&t.active){var e=b.current;e.srcObject=t.clone();var r=t.getVideoTracks()[0],c=function(){console.debug(new Date,"track ended by user"),n(null)};return r.addEventListener("ended",c),Object(S.a)(C.a.mark((function t(){var n,r,c;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.play();case 2:n=b.current,r=n.videoHeight,c=n.videoWidth,b.current.width=c,b.current.height=r,console.log("hi",r,c,b.current.videoHeight,b.current.videoWidth),y();case 7:case"end":return t.stop()}}),t)})))(),function(){console.debug(new Date,"remove stream"),r.removeEventListener("ended",c),e.srcObject.getVideoTracks().forEach((function(e){return e.stop()})),e.srcObject=null,e.removeAttribute("width"),e.removeAttribute("height"),x()}}}),[t,n,y,x]);var k=Object(r.useState)(0),A=Object(d.a)(k,2),F=A[0],_=A[1],I=Object(r.useState)(10),B=Object(d.a)(I,2),W=B[0],G=B[1],U=Object(r.useMemo)((function(){return[{id:"jobId",label:"job ID"},{id:"text",label:"text"}]}),[]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(z,{children:Object(p.jsx)(j.a,{container:!0,justifyContent:"center",item:!0,xs:6,children:Object(p.jsx)(M.a,{className:c.devStreamer,clone:!0,children:Object(p.jsx)("video",{className:c.devStreamerMedia,ref:b})})})}),Object(p.jsx)(j.a,{container:!0,justifyContent:"center",item:!0,xs:6,children:Object(p.jsx)(M.a,{className:c.devStreamer,clone:!0,children:Object(p.jsx)("canvas",{className:c.devStreamerMedia,ref:f})})}),Object(p.jsx)(j.a,{item:!0,xs:12,children:Object(p.jsxs)(P.a,{children:[Object(p.jsx)(E.a,{children:Object(p.jsxs)(L.a,{className:c.table,size:"small",children:[Object(p.jsx)(T.a,{children:Object(p.jsx)(Y.a,{children:U.map((function(e){return Object(p.jsx)(N.a,{children:e.label},e.id)}))})}),Object(p.jsx)(R.a,{children:a.slice(F*W,F*W+W).map((function(e){return Object(p.jsx)(Y.a,{hover:!0,role:"checkbox",tabIndex:-1,children:U.map((function(t){var n=e[t.id];return Object(p.jsx)(N.a,{children:n},t.id)}))},e.code)}))})]})}),Object(p.jsx)(D.a,{rowsPerPageOptions:[10,25,100],component:"div",count:a.length,rowsPerPage:W,page:F,onPageChange:function(e,t){_(t)},onRowsPerPageChange:function(e){G(+e.target.value),_(0)}})]})})]})},Z=n(19),$=n(224),ee=n(245),te=n(104),ne=n.n(te),re=n(105),ce=n.n(re),ae=function(e){var t=e.stream,n=e.setStream,c=m(),a=Object(Z.a)(),o={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},s=Object(r.useState)(!1),i=Object(d.a)(s,2),u=i[0],l=i[1],b=Object(r.useCallback)((function(){l((function(e){return!e}))}),[]);Object(r.useEffect)((function(){var e,t;(null===(e=navigator)||void 0===e||null===(t=e.mediaDevices)||void 0===t?void 0:t.getDisplayMedia)||l(!0)}),[]),Object(r.useEffect)((function(){if(t)return function(){t.getTracks().forEach((function(e){return e.stop()}))}}),[t]);var j=Object(r.useCallback)(function(){var e=Object(S.a)(C.a.mark((function e(t){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({audio:!1});case 3:r=e.sent,n(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error: "+e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),[n]),f=Object(r.useCallback)(function(){var e=Object(S.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n(null)}catch(t){console.error("Error: "+t)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]),h=Object(r.useMemo)((function(){return[{color:"primary",className:c.fab,icon:Object(p.jsx)(ne.a,{className:c.extendedIcon}),label:"\ud654\uba74 \uc120\ud0dd",onClick:j},{color:"secondary",className:c.fab,icon:Object(p.jsx)(ce.a,{className:c.extendedIcon}),label:"\uc885\ub8cc",onClick:f}]}),[c.fab,c.extendedIcon,j,f]);return Object(p.jsxs)(p.Fragment,{children:[h.map((function(e,n){return Object(p.jsx)($.a,{in:0===n?!t:!!t,timeout:o,style:{transitionDelay:"".concat((0===n?!t:t)?o.exit:0,"ms")},unmountOnExit:!0,children:Object(p.jsxs)(ee.a,{variant:"extended","aria-label":e.label,className:e.className,color:e.color,onClick:e.onClick,children:[e.icon,e.label]})},e.color)})),Object(p.jsx)(w,{open:u,handleOpen:b})]})},oe=n(246),se=n(243),ie=n(244),ue=n(247),le=n(106),de=n.n(le),be=function(){var e=m();return Object(p.jsx)(oe.a,{position:"fixed",children:Object(p.jsxs)(se.a,{children:[Object(p.jsx)(ie.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(p.jsx)(de.a,{})}),Object(p.jsx)(ue.a,{variant:"h6",className:e.title,children:"Tesseact React Test"})]})})},je={useStyle:m,modal:y,component:{DevStreamer:Q,MediaSelector:ae,TopBar:be,MouseTracker:z}},fe=je.component,he=fe.DevStreamer,me=fe.MediaSelector,Oe=je.useStyle,xe=function(){var e=Oe(),t=Object(r.useState)(),n=Object(d.a)(t,2),c=n[0],a=n[1];return Object(p.jsxs)(b.a,{maxWidth:"xl",className:e.root,children:[Object(p.jsx)(j.a,{container:!0,item:!0,xs:12,spacing:1,children:Object(p.jsx)(he,{stream:c,setStream:a})}),Object(p.jsx)(me,{stream:c,setStream:a})]})},ve=Object(u.a)();var pe=function(){var e=Object(r.useMemo)((function(){return{logger:function(e){}}}),[]),t=Object(r.useMemo)((function(){return{tessedit_pageseg_mode:A.PSM.AUTO,user_defined_dpi:"70",tessedit_create_box:"1",tessedit_create_unlv:"1",tessedit_create_osd:"1"}}),[]);return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(i.a,{openCvPath:"/webrtc-tesseract/lib/opencv.js",children:Object(p.jsx)(I,{workerCreateOption:e,workerParameter:t,children:Object(p.jsxs)(l.a,{theme:ve,children:[Object(p.jsx)(s.a,{}),Object(p.jsx)(be,{}),Object(p.jsx)(xe,{})]})})})})},ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,249)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(pe,{})}),document.getElementById("root")),ge()}},[[161,1,2]]]);
//# sourceMappingURL=main.023f1ad3.chunk.js.map